<!DOCTYPE html>
<html manifest="expenses.manifest">
<head><title>Expenses</title>
<link rel="shortcut icon" href="https://maker.ifttt.com/favicon.ico">
<link rel="prefetch" href="https://maker.ifttt.com/trigger/">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://ifttt.com/apple-touch-icon-114x114-precomposed.png">
<meta charset="UTF-8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="white">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<style>
html,body,form {margin:0; padding:0}
body {
  margin: 3px;
  padding: 1px;
  overflow: auto;
  background: #fff;
  color: #000;
  -webkit-tap-highlight-color: rgba(0,0,0,0.2);
  -webkit-text-size-adjust: 100%;
}
body, input, select {font: 14pt Helvetica,Arial}
footer {
  padding: 4px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
}
form {
  line-height: 1.5em;
}
section {
  margin: 1em 0;
  text-align: center;
}
label {margin: 0 1%; white-space: nowrap}
input[type=text],
input[type=number],
input[type=tel],
select {text-align: center; width: 100%; box-sizing: border-box}

</style>
</head>
<body>
<form name=f action="#" onsubmit="return false;">
  <section>
    <label><input type=radio name=owner value=me checked>Me</label>
    <label><input type=radio name=owner value=family>Family</label>
    <label><input type=radio name=owner value=parent>Parent</label>
    <label><input type=radio name=owner value=relative>Relative</label>
    <label><input type=radio name=owner value=friend>Friend</label>
    <label><input type=radio name=owner value=work>Work</label>
    <label><input type=radio name=owner value=other>Other</label>
  </section>

  <section>
    <input type=number pattern="[0-9]*" title="Occupants" name=occupy value="1">
  </section>

  <section>
    <select name=cat>
      <option value=meal>Meal
      <option value=snack>Snack
      <option value=drink selected>Drink
      <option value=fun>Fun
      <option value=gift>Gift
      <option value=travel>Travel
      <option value=tool>Tool
      <option value=other>Other
    </select>
  </section>

  <section>
    <input type=text name=what placeholder=Burger autocomplete=off autocorrect=on autocapitalize=off>
  </section>

  <section>
    <input type=text name=brand placeholder=McDonalds autocomplete=off autocorrect=off autocapitalize=words>
  </section>

  <section>
    <label><input type=radio name=fait value="HKD" checked>HKD</label>
    <label><input type=radio name=fait value="CNY">CNY</label>
  </section>

  <section>
    <input type=tel name=cost placeholder="49.50" onchange="this.value=this.value.replace(/,/g,'').replace(/\D/g,'.')">
  </section>

  <section>
    <label><input type=radio name=meth value=cash>Cash</label>
    <label><input type=radio name=meth value=visa>Visa</label>
    <label><input type=radio name=meth value=octopus checked>Octopus</label>
    <label><input type=radio name=meth value=WeChat>WeChat</label>
    <label><input type=radio name=meth value=apple>Apple</label>
  </section>

  <section>
    <input type=text name=more placeholder="Remark" autocomplete=off autocorrect=off autocapitalize=off>
  </section>

  <footer>
    <a href="#" onclick="if(confirm('Reset?')){document.f.reset();localStorage.clear();}">Reset</a>
    <input type=button value=Submit onclick="doit();">
  </footer>
</form>
<script>
let elms = document.f.elements;
document.f.reset();
for(let i = 0; i < elms.length; i++) {
  let name = elms[i].name;
  if(name) {
    elms[i].onkeyup = elms[i].onclick = e => {
      localStorage["f_" + name] = elms[i].value;
    };
    let value = localStorage["f_" + name];
    if(value) elms[i].value = value;
  }
}

function doit() {
  let arr = [];
  for(let i = 0; i < elms.length; i++) {
    if(elms[i].name) {
      if(elms[i].type != "radio" || elms[i].checked) {
        arr.push(elms[i].name+"="+encodeURIComponent(elms[i].value));
      }
    }
  }
  arr = arr.join(encodeURIComponent("\n"));
  let param = "value1="+encodeURIComponent(navigator.oscpu)+"&value2="+arr+"&value3="+document.f.cost.value;
  document.body.onunload = () => {
    localStorage.clear();
    document.f.reset();
  };
  location.href = "https://maker.ifttt.com/trigger/expenses/with/key/c0MQTa0bpsYERESiLzpsnL?"+param;
}
</script>
</body>
</html>
